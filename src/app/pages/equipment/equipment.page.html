<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/manage-work-order" color="telco"></ion-back-button>
    </ion-buttons>
    <ion-title color="telcoSecondary">Gesti√≥n de insumos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form [formGroup]="equipmentForm" #equipmentFormRef="ngForm" novalidate>

    <ion-list-header>
      <h5>Equipos</h5>
    </ion-list-header>

    <ion-row>
      <ion-col>

        <ion-item class="item-select" lines="none">
          <ion-label position="stacked">Equipos:</ion-label>
          <br>
          <select class="text-small" formControlName="equipment">
            <option [value]="null" disabled selected>
              Seleccione un equipo
            </option>
            <option *ngFor="let equipment of equipments" [value]="equipment.idParamGenericActividad">
              {{ equipment.nombreGeneric }}
            </option>
          </select>
        </ion-item>
        <div class="text-tiny ion-text-right">
          <ion-text color="danger">
            <span
              [style.visibility]="f['equipment'].errors?.['required'] && equipmentFormRef?.submitted ? '' : 'hidden'">
              Campo requerido
            </span>
          </ion-text>
        </div>

        <ion-item>
          <ion-label position="floating">Serial:</ion-label>
          <ion-input type="text" placeholder="Serial" formControlName="Serial" required></ion-input>

          <ion-button (click)="viewScanner()" slot="end" expand="block" color="telcoSecondary">
            <ion-icon slot="icon-only" name="barcode-outline"></ion-icon>
          </ion-button>

        </ion-item>
        <div class="text-tiny ion-text-right">
          <ion-text color="danger">
            <span [style.visibility]="f['Serial'].errors?.['required'] && equipmentFormRef?.submitted ? '' : 'hidden'">
              Campo requerido
            </span>
          </ion-text>
        </div>

        <ion-item class="item-select" lines="none">
          <ion-label position="stacked">Movimientos:</ion-label>
          <br>
          <select class="text-small" formControlName="movement">
            <option [value]="null" disabled selected>
              Seleccione un movimiento
            </option>
            <option *ngFor="let movement of states" [value]="movement.id">
              {{ movement.name }}
            </option>
          </select>
        </ion-item>
        <div class="text-tiny ion-text-right">
          <ion-text color="danger">
            <span
              [style.visibility]="f['movement'].errors?.['required'] && equipmentFormRef?.submitted ? '' : 'hidden'">
              Campo requerido
            </span>
          </ion-text>
        </div>

      </ion-col>
    </ion-row>

    <br>

    <ion-button (click)="onSubmit()" expand="block" color="telcoSecondary">
      Adicionar
    </ion-button>

  </form>

  <br>

  <ion-list>
    <ion-list-header>
      <ion-col col-4>
        <ion-label>
          <h3 class="text-bold text-small ion-text-center">Cod:</h3>
        </ion-label>
      </ion-col>
      <ion-col col-4>
        <ion-label>
          <h3 class="text-bold text-small">Equipo:</h3>
        </ion-label>
      </ion-col>
      <ion-col col-4>
        <ion-label>
          <h3 class="text-bold text-small">Serial:</h3>
        </ion-label>
      </ion-col>
      <ion-col col-4>
        <ion-label>
          <h3 class="text-bold text-small">Movimiento:</h3>
        </ion-label>
      </ion-col>

    </ion-list-header>
    <ion-item-sliding *ngFor="let equipment of (equipmentsArray)">

      <ion-item>

        <ion-col col-4>
          <ion-label>
            <h3 class="text-small ion-text-center ion-text-wrap">{{equipment.codeEquipmentDto}}</h3>
          </ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>
            <h3 class="text-small ion-text-wrap">{{equipment.decriptionEquipmentDto}}</h3>
          </ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label>
            <h3 class="text-small ion-text-wrap">{{equipment.serialDto}}</h3>
          </ion-label>
        </ion-col>
        <ion-col col-4>
          <ion-label class="">
            <h3 class="text-small ion-text-wrap ion-text-center">{{equipment.movement}}</h3>
          </ion-label>
        </ion-col>

      </ion-item>

      <ion-item-options side="end">
        <ion-item-option color="danger" (click)="deleteEquipment(equipment.codeEquipmentDto)">
          <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
        </ion-item-option>
      </ion-item-options>

    </ion-item-sliding>

  </ion-list>
</ion-content>
